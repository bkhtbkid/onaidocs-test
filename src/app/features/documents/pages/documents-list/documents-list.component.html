<div class="py-4 flex items-center justify-between">
  <h2 class="font-bold size-8">Документы</h2>
  <button
    (click)="onCreateDocument()"
    class="flex gap-x-2 items-center px-2 py-1 bg-blue-500 text-white rounded-lg"
  >
    +
    <span>Документ</span>
  </button>
</div>

<div class="flex flex-col gap-4">
  <div class="flex gap-x-3">
    <input
      [formControl]="searchControl"
      placeholder="Поиск по названию..."
      class="rounded-md border border-gray-300 focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50 py-1 px-2"
    >

    <select [value]="status()" class="" (change)="onStatusChange($event)">
      <option value="ALL">Все статусы</option>
      <option value="DRAFT">Черновик</option>
      <option value="SIGNED">Подписан</option>
      <option value="ARCHIVED">В архиве</option>
    </select>
  </div>

  @if (list() && list().length > 0) {
    <div class="border rounded-lg max-h-[60vh] overflow-y-auto">
      <div class="overflow-x-auto">
        <table class="border rounded-lg min-w-[900px] relative w-full">
          <thead class="sticky top-0 bg-white">
          <tr class="text-left">
            <th class="px-4 py-2 w-[5%]">ID</th>
            <th class="px-4 py-2 w-[15%]">Автор</th>
            <th class="px-4 py-2 w-[25%]">Название</th>
            <th
              class="px-4 py-2 cursor-pointer inline-flex items-center gap-x-1"
              (click)="onToggleDateSort()"
            >
              Дата
              <img
                alt="arrow-down"
                src="assets/icons/arrow-down.svg"
                class="w-3 h-3 transition-transform duration-200 rotate-180"
                [ngClass]="{
                  'rotate-0': sortDirection === 'desc',
                  'rotate-180': sortDirection === 'asc'
                }"
              />
            </th>
            <th class="px-4 py-2 w-[55%]">Описание</th>
            <th class="px-4 py-2 w-[20%]">Статус</th>
          </tr>
          </thead>
          <tbody>
            @for (document of list(); track document.id) {
              <tr
                (click)="onDocument(document)"
                class="border-t hover:bg-gray-100 cursor-pointer"
              >
                <td class="px-4 py-2 ">{{ document.id }}</td>
                <td class="px-4 py-2 ">{{ document.author }}</td>
                <td class="px-4 py-2 ">{{ document.title }}</td>
                <td class="px-4 py-2 ">
                  {{ document.updatedAt | date: 'dd.MM.yyyy' }}
                </td>
                <td class="px-4 py-2 ">
                  {{ document.content }}
                </td>
                <td class="px-4 py-2 ">
                  {{ document.status | statusLabel }}
                </td>
              </tr>
            }
          </tbody>
        </table>
      </div>
    </div>
    <div class="flex justify-end mt-3 gap-x-4 mb-5">
      <select (change)="onPageSizeChange($event)" [ngModel]="pageSize">
        @for (opt of pageSizeOptions; track opt) {
          <option [value]="opt">{{ opt }}</option>
        }
      </select>
      <div class="flex gap-x-2">
        <button (click)="onPrevPage()"><</button>
        <span>
          Страница {{ page }} из {{ getPageCount() }}
        </span>
        <button (click)="onNextPage()">></button>
      </div>
    </div>
  }
</div>
